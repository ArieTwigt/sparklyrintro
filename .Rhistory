library(sparklyr)
sc <- spark_connect(master = "local",
app_name = "ariespark")
library(parallel)
detectCores()
config <- spark_config()
config
config$sparklyr.connect.cores.local <- 3
config$`sparklyr.shell.driver-memory` <- "4G"
config$`sparklyr.shell.executor-memory` <- "4G"
config$`spark.yarn.executor.memoryOverhead` <- "1g"
config
dim(autos)
library(readr)
alleen_personenauto <- read_csv("data/alleen_personenauto.csv")
dim(autos)
dim(alleen_personenauto)
library(dplyr)
alleen_personenauto$jaar <- substr(alleen_personenauto$`Datum tenaamstelling`, 7, 10)
alleen_personenauto_filtered <- alleen_personenauto[alleen_personenauto$jaar == '2016',]
rm(alleen_personenauto)
start <- Sys.time()
autos_tbl <- copy_to(sc, alleen_personenauto_filtered)
config$sparklyr.connect.cores.local <- 4
config$`sparklyr.shell.driver-memory` <- "4G"
config$`sparklyr.shell.executor-memory` <- "4G"
config$`spark.yarn.executor.memoryOverhead` <- "512mb"
config
start <- Sys.time()
autos_tbl <- copy_to(sc, alleen_personenauto_filtered)
config$sparklyr.connect.cores.local <- 4
config$`sparklyr.shell.driver-memory` <- "4G"
config$`sparklyr.shell.executor-memory` <- "4G"
config$`spark.yarn.executor.memoryOverhead` <- "4g"
config
start <- Sys.time()
autos_tbl <- copy_to(sc, alleen_personenauto_filtered)
library(parallel)
detectCores()
library(sparklyr)
sc <- spark_connect(master = "local",
app_name = "ariespark")
config <- spark_config()
config
config$sparklyr.connect.cores.local <- 4
config$`sparklyr.shell.driver-memory` <- "4g"
config$`sparklyr.shell.executor-memory` <- "4g"
config$`spark.yarn.executor.memoryOverhead` <- "1g"
config
library(readr)
alleen_personenauto <- read_csv("data/alleen_personenauto.csv")
alleen_personenauto$jaar <- substr(alleen_personenauto$`Datum tenaamstelling`, 7, 10)
alleen_personenauto_filtered <- alleen_personenauto[alleen_personenauto$jaar == '2016',]
# write table
write.csv(alleen_personenauto_filtered, "alleen_personenauto_filtered", sep = ";", row.names = FALSE)
remove(list = ls())
library(sparklyr)
sc <- spark_connect(master = "local",
app_name = "ariespark")
config <- spark_config()
config
config$sparklyr.connect.cores.local <- 4
config$`sparklyr.shell.driver-memory` <- "2g"
config$`sparklyr.shell.executor-memory` <- "2g"
config$`spark.yarn.executor.memoryOverhead` <- "1g"
config
library(readr)
alleen_personenauto <- as.data.frame(read_csv("data/alleen_personenauto_filtered.csv"))
library(readr)
alleen_personenauto <- read_csv("data/alleen_personenauto_filtered.csv")
dim(alleen_personenauto)
library(dplyr)
alleen_personenauto$jaar <- substr(alleen_personenauto$`Datum tenaamstelling`, 7, 10)
alleen_personenauto_filtered <- alleen_personenauto[alleen_personenauto$jaar == '2016',]
start <- Sys.time()
autos_tbl <- copy_to(sc, alleen_personenauto_filtered)
summary(factor(alleen_personenauto_filtered$Voertuigsoort))
summary(factor(alleen_personenauto_filtered$`Aantal zitplaatsen`))
alleen_personenauto_filtered <- alleen_personenauto_filtered[alleen_personenauto_filtered$`Aantal zitplaatsen` == 2,]
# write table
write.csv(alleen_personenauto_filtered, "alleen_personenauto_filtered", sep = ";", row.names = FALSE)
# write table
write.csv(alleen_personenauto_filtered, "alleen_personenauto_filtered.csv", sep = ";", row.names = FALSE)
